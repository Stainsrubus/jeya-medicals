var L=t=>{throw TypeError(t)};var U=(t,e,s)=>e.has(t)||L("Cannot "+s);var a=(t,e,s)=>(U(t,e,"read from private field"),s?s.call(t):e.get(t)),o=(t,e,s)=>e.has(t)?L("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),h=(t,e,s,r)=>(U(t,e,"write to private field"),r?r.call(t,s):e.set(t,s),s);var T=(t,e,s,r)=>({set _(i){h(t,e,i,s)},get _(){return a(t,e,r)}});import{S as se,q as re,n as c,u as W,v as G,a as g,e as ne,w as ue,x as he,m as oe,y as J,j as V,z as ce,h as X,A as Y,s as le}from"./Dsyf9IYo.js";import{Q as fe}from"./BGx83ahh.js";import{M as de}from"./B2vDT1jC.js";const ye=!0,ge=ye;var y,x,pe=(x=class extends se{constructor(e={}){super();o(this,y);this.config=e,h(this,y,new Map)}build(e,s,r){const i=s.queryKey,u=s.queryHash??re(i,s);let d=this.get(u);return d||(d=new fe({cache:this,queryKey:i,queryHash:u,options:e.defaultQueryOptions(s),state:r,defaultOptions:e.getQueryDefaults(i)}),this.add(d)),d}add(e){a(this,y).has(e.queryHash)||(a(this,y).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const s=a(this,y).get(e.queryHash);s&&(e.destroy(),s===e&&a(this,y).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){c.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return a(this,y).get(e)}getAll(){return[...a(this,y).values()]}find(e){const s={exact:!0,...e};return this.getAll().find(r=>W(s,r))}findAll(e={}){const s=this.getAll();return Object.keys(e).length>0?s.filter(r=>W(e,r)):s}notify(e){c.batch(()=>{this.listeners.forEach(s=>{s(e)})})}onFocus(){c.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){c.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},y=new WeakMap,x),p,f,F,ee,me=(ee=class extends se{constructor(e={}){super();o(this,p);o(this,f);o(this,F);this.config=e,h(this,p,new Set),h(this,f,new Map),h(this,F,0)}build(e,s,r){const i=new de({mutationCache:this,mutationId:++T(this,F)._,options:e.defaultMutationOptions(s),state:r});return this.add(i),i}add(e){a(this,p).add(e);const s=H(e);if(typeof s=="string"){const r=a(this,f).get(s);r?r.push(e):a(this,f).set(s,[e])}this.notify({type:"added",mutation:e})}remove(e){if(a(this,p).delete(e)){const s=H(e);if(typeof s=="string"){const r=a(this,f).get(s);if(r)if(r.length>1){const i=r.indexOf(e);i!==-1&&r.splice(i,1)}else r[0]===e&&a(this,f).delete(s)}}this.notify({type:"removed",mutation:e})}canRun(e){const s=H(e);if(typeof s=="string"){const r=a(this,f).get(s),i=r==null?void 0:r.find(u=>u.state.status==="pending");return!i||i===e}else return!0}runNext(e){var r;const s=H(e);if(typeof s=="string"){const i=(r=a(this,f).get(s))==null?void 0:r.find(u=>u!==e&&u.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){c.batch(()=>{a(this,p).forEach(e=>{this.notify({type:"removed",mutation:e})}),a(this,p).clear(),a(this,f).clear()})}getAll(){return Array.from(a(this,p))}find(e){const s={exact:!0,...e};return this.getAll().find(r=>G(s,r))}findAll(e={}){return this.getAll().filter(s=>G(e,s))}notify(e){c.batch(()=>{this.listeners.forEach(s=>{s(e)})})}resumePausedMutations(){const e=this.getAll().filter(s=>s.state.isPaused);return c.batch(()=>Promise.all(e.map(s=>s.continue().catch(g))))}},p=new WeakMap,f=new WeakMap,F=new WeakMap,ee);function H(t){var e;return(e=t.options.scope)==null?void 0:e.id}function Z(t){return{onFetch:(e,s)=>{var k,I,R,j,B;const r=e.options,i=(R=(I=(k=e.fetchOptions)==null?void 0:k.meta)==null?void 0:I.fetchMore)==null?void 0:R.direction,u=((j=e.state.data)==null?void 0:j.pages)||[],d=((B=e.state.data)==null?void 0:B.pageParams)||[];let A={pages:[],pageParams:[]},E=0;const S=async()=>{let b=!1;const C=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(e.signal.aborted?b=!0:e.signal.addEventListener("abort",()=>{b=!0}),e.signal)})},ae=ne(e.options,e.fetchOptions),_=async(l,m,D)=>{if(b)return Promise.reject();if(m==null&&l.pages.length)return Promise.resolve(l);const K={queryKey:e.queryKey,pageParam:m,direction:D?"backward":"forward",meta:e.options.meta};C(K);const ie=await ae(K),{maxPages:N}=e.options,z=D?ue:he;return{pages:z(l.pages,ie,N),pageParams:z(l.pageParams,m,N)}};if(i&&u.length){const l=i==="backward",m=l?ve:$,D={pages:u,pageParams:d},K=m(r,D);A=await _(D,K,l)}else{const l=t??u.length;do{const m=E===0?d[0]??r.initialPageParam:$(r,A);if(E>0&&m==null)break;A=await _(A,m),E++}while(E<l)}return A};e.options.persister?e.fetchFn=()=>{var b,C;return(C=(b=e.options).persister)==null?void 0:C.call(b,S,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},s)}:e.fetchFn=S}}}function $(t,{pages:e,pageParams:s}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,s[r],s):void 0}function ve(t,{pages:e,pageParams:s}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,s[0],s):void 0}var n,v,P,O,M,Q,w,q,te,Pe=(te=class{constructor(t={}){o(this,n);o(this,v);o(this,P);o(this,O);o(this,M);o(this,Q);o(this,w);o(this,q);h(this,n,t.queryCache||new pe),h(this,v,t.mutationCache||new me),h(this,P,t.defaultOptions||{}),h(this,O,new Map),h(this,M,new Map),h(this,Q,0)}mount(){T(this,Q)._++,a(this,Q)===1&&(h(this,w,oe.subscribe(async t=>{t&&(await this.resumePausedMutations(),a(this,n).onFocus())})),h(this,q,J.subscribe(async t=>{t&&(await this.resumePausedMutations(),a(this,n).onOnline())})))}unmount(){var t,e;T(this,Q)._--,a(this,Q)===0&&((t=a(this,w))==null||t.call(this),h(this,w,void 0),(e=a(this,q))==null||e.call(this),h(this,q,void 0))}isFetching(t){return a(this,n).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return a(this,v).findAll({...t,status:"pending"}).length}getQueryData(t){var s;const e=this.defaultQueryOptions({queryKey:t});return(s=a(this,n).get(e.queryHash))==null?void 0:s.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),s=a(this,n).build(this,e),r=s.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&s.isStaleByTime(V(e.staleTime,s))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return a(this,n).findAll(t).map(({queryKey:e,state:s})=>{const r=s.data;return[e,r]})}setQueryData(t,e,s){const r=this.defaultQueryOptions({queryKey:t}),i=a(this,n).get(r.queryHash),u=i==null?void 0:i.state.data,d=ce(e,u);if(d!==void 0)return a(this,n).build(this,r).setData(d,{...s,manual:!0})}setQueriesData(t,e,s){return c.batch(()=>a(this,n).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,s)]))}getQueryState(t){var s;const e=this.defaultQueryOptions({queryKey:t});return(s=a(this,n).get(e.queryHash))==null?void 0:s.state}removeQueries(t){const e=a(this,n);c.batch(()=>{e.findAll(t).forEach(s=>{e.remove(s)})})}resetQueries(t,e){const s=a(this,n),r={type:"active",...t};return c.batch(()=>(s.findAll(t).forEach(i=>{i.reset()}),this.refetchQueries(r,e)))}cancelQueries(t,e={}){const s={revert:!0,...e},r=c.batch(()=>a(this,n).findAll(t).map(i=>i.cancel(s)));return Promise.all(r).then(g).catch(g)}invalidateQueries(t,e={}){return c.batch(()=>{if(a(this,n).findAll(t).forEach(r=>{r.invalidate()}),(t==null?void 0:t.refetchType)==="none")return Promise.resolve();const s={...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"};return this.refetchQueries(s,e)})}refetchQueries(t,e={}){const s={...e,cancelRefetch:e.cancelRefetch??!0},r=c.batch(()=>a(this,n).findAll(t).filter(i=>!i.isDisabled()).map(i=>{let u=i.fetch(void 0,s);return s.throwOnError||(u=u.catch(g)),i.state.fetchStatus==="paused"?Promise.resolve():u}));return Promise.all(r).then(g)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const s=a(this,n).build(this,e);return s.isStaleByTime(V(e.staleTime,s))?s.fetch(e):Promise.resolve(s.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(g).catch(g)}fetchInfiniteQuery(t){return t.behavior=Z(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(g).catch(g)}ensureInfiniteQueryData(t){return t.behavior=Z(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return J.isOnline()?a(this,v).resumePausedMutations():Promise.resolve()}getQueryCache(){return a(this,n)}getMutationCache(){return a(this,v)}getDefaultOptions(){return a(this,P)}setDefaultOptions(t){h(this,P,t)}setQueryDefaults(t,e){a(this,O).set(X(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...a(this,O).values()],s={};return e.forEach(r=>{Y(t,r.queryKey)&&Object.assign(s,r.defaultOptions)}),s}setMutationDefaults(t,e){a(this,M).set(X(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...a(this,M).values()];let s={};return e.forEach(r=>{Y(t,r.mutationKey)&&(s={...s,...r.defaultOptions})}),s}defaultQueryOptions(t){if(t._defaulted)return t;const e={...a(this,P).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=re(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===le&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...a(this,P).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){a(this,n).clear(),a(this,v).clear()}},n=new WeakMap,v=new WeakMap,P=new WeakMap,O=new WeakMap,M=new WeakMap,Q=new WeakMap,w=new WeakMap,q=new WeakMap,te);const we=new Pe({defaultOptions:{queries:{enabled:ge,refetchOnWindowFocus:!1,staleTime(){return 7e3}}}});export{Pe as Q,ge as b,we as q};
