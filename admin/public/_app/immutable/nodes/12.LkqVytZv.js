import"../chunks/Bg9kRutz.js";import"../chunks/69_IOA4Y.js";import{w as Ye,p as Qe,u as Be,g as l,X as d,s,t as q,a as Re,b as Ie,d as we,c as $,n as c,e as ve,r as _,ad as Ze,f as E,$ as er}from"../chunks/DUB8bsv0.js";import{s as S}from"../chunks/3nqkJHLA.js";import{b as v,a as t,t as P,c as xe,h as rr}from"../chunks/DzHOuBan.js";import{i as tr}from"../chunks/B06qfcxv.js";import{d as O,c as be,i as K,s as je,a as te,p as ze,e as ar}from"../chunks/DOmRzZIo.js";import{R as or}from"../chunks/B_rXABv2.js";import{s as sr,z as Ke,d as ir,a as nr}from"../chunks/BTJgjqp0.js";import{_ as Ee}from"../chunks/c3aSOx29.js";import{B as dr}from"../chunks/CJvYq0KN.js";import{I as ge}from"../chunks/CJXCr1W0.js";import{L as he}from"../chunks/DSP103xp.js";import{T as lr}from"../chunks/B1uj5A9L.js";import{z as re}from"../chunks/K85sQPP8.js";import{q as Je}from"../chunks/tFu-0XeD.js";import{t as Ae}from"../chunks/CF63kifO.js";import"../chunks/CSUTd-D0.js";import{c as We}from"../chunks/Dw1g5TC4.js";import{e as ur,i as cr}from"../chunks/DJVbMBk7.js";import{c as p}from"../chunks/yzD5jbIF.js";import{P as vr,T as Ue}from"../chunks/BTrfwMzp.js";import{S as mr}from"../chunks/CJEhnKgE.js";import{T as pr,a as $r,b as Ve,c as ue,d as _r,e as ce}from"../chunks/4wux5xE3.js";import{I as ke}from"../chunks/CHPYNWro.js";import{c as fr}from"../chunks/B6Jqkcen.js";import{T as xr,a as Xe}from"../chunks/B_RvuQCl.js";import{T as Ge}from"../chunks/CBD-qeiU.js";const Oe=Ye({mode:"list",id:"",code:"",description:"",discount:"",minPrice:0,maxPrice:0,numberOfDays:0}),He=re.object({code:re.string({required_error:"Coupon code is required"}).max(50,"Coupon code cannot exceed 50 characters").min(1,"Coupon code is required"),description:re.string({required_error:"Description is required"}).min(1,"Description is required"),discount:re.string().refine(R=>/^[0-9]+$/.test(R),{message:"Servings must be a numeric string"}),active:re.boolean().default(!0),minPrice:re.number({required_error:"Minimum price is required",invalid_type_error:"Minimum price must be a number"}).min(1,"Minimum price must be at least 1"),maxPrice:re.number({required_error:"Maximum price is required",invalid_type_error:"Maximum price must be a number"}).min(1,"Maximum price must be at least 1"),numberOfDays:re.number({required_error:"Number of days is required",invalid_type_error:"Number of days must be a number"}).min(1,"Number of days must be at least 1").int("Number of days must be a whole number")}).refine(R=>R.maxPrice>=R.minPrice,{message:"Maximum price must be greater than minimum price",path:["maxPrice"]});var br=P('<span class="invalid text-red-500 text-xs"> </span>'),hr=P('<span class="invalid text-red-500 text-xs"> </span>'),gr=P('<span class="invalid text-red-500 text-xs"> </span>'),Pr=P('<span class="invalid text-red-500 text-xs"> </span>'),yr=P('<span class="invalid text-red-500 text-xs"> </span>'),Cr=P('<span class="invalid text-red-500 text-xs"> </span>'),Dr=P('<div class="max-w-[80%] mx-auto text-maintext"><form method="POST" class="grid gap-4 py-4"><div><!> <!> <!></div> <div><!> <!> <!></div> <div><!> <!> <!></div> <div class="grid grid-cols-2 gap-4"><div><!> <!> <!></div> <div><!> <!> <!></div></div> <div><!> <!> <!></div> <!></form></div>');function wr(R,ae){Qe(ae,!0);const[j,Pe]=je(),u=()=>te(ae.couponsStore,"$couponsStore",j),F=()=>te(me,"$createCouponMutation",j),a=()=>te(m,"$form",j),T=()=>te(oe,"$constraints",j),n=()=>te(pe,"$errors",j);let N=Ie(!1);Be(()=>{we(N,ze(!!(u().mode==="create"&&u().id)))});const me=We({mutationFn:e=>l(N)?Ee.put(`/coupon/${u().id}`,e):Ee.post("/coupon/",e),onSuccess(){Je.refetchQueries({queryKey:["coupons"]}),O(ae.couponsStore,d(u).mode="list",d(u)),U(),Ae(l(N)?"Coupon Updated ":"Coupon Created ")},onError(e){console.error("Error:",e),Ae.error("Failed to save coupon")}}),{form:m,errors:pe,enhance:H,reset:U,constraints:oe,validateForm:J}=sr(ir(Ke(He)),{SPA:!0,validationMethod:"oninput",validators:Ke(He),clearOnSubmit:"none",invalidateAll:!1,resetForm:!1,async onSubmit(){const{valid:e}=await J({focusOnError:!0});e&&F().mutate(a())}});Be(()=>{l(N)?(O(m,d(a).code=u().code,d(a)),O(m,d(a).description=u().description,d(a)),O(m,d(a).minPrice=u().minPrice,d(a)),O(m,d(a).maxPrice=u().maxPrice,d(a)),O(m,d(a).discount=u().discount,d(a)),O(m,d(a).numberOfDays=u().numberOfDays,d(a))):U()});var W=Dr(),L=$(W),B=$(L),se=$(B);he(se,{for:"code",children:(e,r)=>{c();var o=v("Coupon Code");t(e,o)},$$slots:{default:!0}});var ie=s(se,2),qe=ve(()=>n().code?"true":void 0);ge(ie,be({id:"code",class:"mt-1",placeholder:"Enter coupon code"},()=>T().code,{get"aria-invalid"(){return l(qe)},get value(){return a().code},set value(e){O(m,d(a).code=e,d(a))}}));var Fe=s(ie,2);{var Ne=e=>{var r=br(),o=$(r,!0);_(r),q(()=>S(o,n().code)),t(e,r)};K(Fe,e=>{n().code&&e(Ne)})}_(B);var i=s(B,2),I=$(i);he(I,{for:"description",children:(e,r)=>{c();var o=v("Description");t(e,o)},$$slots:{default:!0}});var y=s(I,2),ne=ve(()=>n().description?"true":void 0);lr(y,be({id:"description",class:"mt-1",placeholder:"Enter coupon description",rows:3},()=>T().description,{get"aria-invalid"(){return l(ne)},get value(){return a().description},set value(e){O(m,d(a).description=e,d(a))}}));var Se=s(y,2);{var Te=e=>{var r=hr(),o=$(r,!0);_(r),q(()=>S(o,n().description)),t(e,r)};K(Se,e=>{n().description&&e(Te)})}_(i);var ye=s(i,2),Me=$(ye);he(Me,{for:"discount",children:(e,r)=>{c();var o=v("Discount (%)");t(e,o)},$$slots:{default:!0}});var Ce=s(Me,2),Le=ve(()=>n().discount?"true":void 0);ge(Ce,be({id:"discount",type:"string",class:"mt-1",placeholder:"Enter discount in % (Ex : 2)"},()=>T().discount,{get"aria-invalid"(){return l(Le)},get value(){return a().discount},set value(e){O(m,d(a).discount=e,d(a))}}));var k=s(Ce,2);{var z=e=>{var r=gr(),o=$(r,!0);_(r),q(()=>S(o,n().discount)),t(e,r)};K(k,e=>{n().discount&&e(z)})}_(ye);var A=s(ye,2),V=$(A),C=$(V);he(C,{for:"minPrice",children:(e,r)=>{c();var o=v("Minimum Price");t(e,o)},$$slots:{default:!0}});var D=s(C,2),w=ve(()=>n().minPrice?"true":void 0);ge(D,be({id:"minPrice",type:"number",class:"mt-1",placeholder:"Enter minimum price"},()=>T().minPrice,{get"aria-invalid"(){return l(w)},get value(){return a().minPrice},set value(e){O(m,d(a).minPrice=e,d(a))}}));var f=s(D,2);{var de=e=>{var r=Pr(),o=$(r,!0);_(r),q(()=>S(o,n().minPrice)),t(e,r)};K(f,e=>{n().minPrice&&e(de)})}_(V);var Y=s(V,2),Z=$(Y);he(Z,{for:"maxPrice",children:(e,r)=>{c();var o=v("Maximum Price");t(e,o)},$$slots:{default:!0}});var X=s(Z,2),$e=ve(()=>n().maxPrice?"true":void 0);ge(X,be({id:"maxPrice",type:"number",class:"mt-1",placeholder:"Enter maximum price"},()=>T().maxPrice,{get"aria-invalid"(){return l($e)},get value(){return a().maxPrice},set value(e){O(m,d(a).maxPrice=e,d(a))}}));var _e=s(X,2);{var De=e=>{var r=yr(),o=$(r,!0);_(r),q(()=>S(o,n().maxPrice)),t(e,r)};K(_e,e=>{n().maxPrice&&e(De)})}_(Y),_(A);var G=s(A,2),ee=$(G);he(ee,{for:"numberOfDays",children:(e,r)=>{c();var o=v("Number of Days");t(e,o)},$$slots:{default:!0}});var le=s(ee,2),x=ve(()=>n().numberOfDays?"true":void 0);ge(le,be({id:"numberOfDays",type:"number",class:"mt-1",placeholder:"Enter number of days the coupon will be active"},()=>T().numberOfDays,{get"aria-invalid"(){return l(x)},get value(){return a().numberOfDays},set value(e){O(m,d(a).numberOfDays=e,d(a))}}));var b=s(le,2);{var h=e=>{var r=Cr(),o=$(r,!0);_(r),q(()=>S(o,n().numberOfDays)),t(e,r)};K(b,e=>{n().numberOfDays&&e(h)})}_(G);var Q=s(G,2);dr(Q,{type:"submit",class:"w-[100px]",get disabled(){return F().isPending},children:(e,r)=>{c();var o=v();q(()=>S(o,l(N)?"Update":"Create")),t(e,o)},$$slots:{default:!0}}),_(L),nr(L,e=>H==null?void 0:H(e)),_(W),t(R,W),Re(),Pe()}var qr=P("<!> <!> <!> <!> <!> <!> <!>",1),Sr=P("<!> <!> <!> <!> <!> <!> <!>",1),Tr=P("<!> <!> <!>",1),Mr=P('<div class="mt-6 text-maintext w-[calc(100vw-420px)] font-pt mx-auto overflow-auto"><div class="w-[40%] ml-auto mb-4"><div class="grid gap-2 relative"><!> <!></div></div> <div class="overflow-x-auto"><!> <!></div></div>');function Or(R,ae){Qe(ae,!0);const[j,Pe]=je(),u=()=>te(pe,"$query",j),F=()=>te(H,"$deleteMutation",j);let a=Ie(1),T=7,n=Ie(""),N;function me(){clearTimeout(N),N=setTimeout(async()=>{await Ze(),we(a,1),u().refetch()},500)}async function m(i,I,y){const{data:ne}=await Ee.get(`/coupon/?limit=${i}&page=${I}&q=${y}`);return ne}const pe=fr({queryKey:["coupons"],queryFn:()=>m(T,l(a),l(n))}),H=We({mutationFn:i=>Ee.delete(`/coupon/${i}`),onSuccess({data:i}){Ae((i==null?void 0:i.message)||"Coupon Deleted âœ…"),Je.refetchQueries()},onError(i){console.error("Delete Error:",i)}});var U=Mr(),oe=$(U),J=$(oe),W=$(J);ge(W,{type:"text",class:"pr-10",placeholder:"Search Coupon",oninput:me,get value(){return l(n)},set value(i){we(n,ze(i))}});var L=s(W,2);{var B=i=>{ke(i,{icon:"iconamoon:search",class:"absolute right-2 bottom-2.5 cursor-pointer text-gray-400 text-xl"})},se=i=>{ke(i,{icon:"mdi:clear-outline",class:"absolute right-2 bottom-2.5 cursor-pointer text-gray-400 text-xl",$$events:{click:()=>{we(n,""),me()}}})};K(L,i=>{l(n)?i(se,!1):i(B)})}_(J),_(oe);var ie=s(oe,2),qe=$(ie);p(qe,()=>pr,(i,I)=>{I(i,{children:(y,ne)=>{var Se=Tr(),Te=E(Se);{var ye=k=>{var z=xe(),A=E(z);p(A,()=>Ue,(V,C)=>{C(V,{children:(D,w)=>{c();var f=v("Loading...");t(D,f)},$$slots:{default:!0}})}),t(k,z)},Me=k=>{var z=xe(),A=E(z);{var V=C=>{var D=xe(),w=E(D);p(w,()=>Ue,(f,de)=>{de(f,{children:(Y,Z)=>{c();var X=v("No Coupons Found!");t(Y,X)},$$slots:{default:!0}})}),t(C,D)};K(A,C=>{var D,w;((w=(D=u())==null?void 0:D.data)==null?void 0:w.total)===0&&C(V)},!0)}t(k,z)};K(Te,k=>{u().isLoading?k(ye):k(Me,!1)})}var Ce=s(Te,2);p(Ce,()=>$r,(k,z)=>{z(k,{children:(A,V)=>{var C=xe(),D=E(C);p(D,()=>Ve,(w,f)=>{f(w,{children:(de,Y)=>{var Z=qr(),X=E(Z);p(X,()=>ue,(x,b)=>{b(x,{class:"w-[100px]",children:(h,Q)=>{c();var e=v("Sl.No");t(h,e)},$$slots:{default:!0}})});var $e=s(X,2);p($e,()=>ue,(x,b)=>{b(x,{children:(h,Q)=>{c();var e=v("Code");t(h,e)},$$slots:{default:!0}})});var _e=s($e,2);p(_e,()=>ue,(x,b)=>{b(x,{children:(h,Q)=>{c();var e=v("Description");t(h,e)},$$slots:{default:!0}})});var De=s(_e,2);p(De,()=>ue,(x,b)=>{b(x,{children:(h,Q)=>{c();var e=v("Discount");t(h,e)},$$slots:{default:!0}})});var G=s(De,2);p(G,()=>ue,(x,b)=>{b(x,{children:(h,Q)=>{c();var e=v("Price Range");t(h,e)},$$slots:{default:!0}})});var ee=s(G,2);p(ee,()=>ue,(x,b)=>{b(x,{children:(h,Q)=>{c();var e=v("Valid Days");t(h,e)},$$slots:{default:!0}})});var le=s(ee,2);p(le,()=>ue,(x,b)=>{b(x,{children:(h,Q)=>{c();var e=v("Active");t(h,e)},$$slots:{default:!0}})}),t(de,Z)},$$slots:{default:!0}})}),t(A,C)},$$slots:{default:!0}})});var Le=s(Ce,2);p(Le,()=>_r,(k,z)=>{z(k,{children:(A,V)=>{var C=xe(),D=E(C);ur(D,1,()=>{var w,f;return((f=(w=u())==null?void 0:w.data)==null?void 0:f.data)||[]},cr,(w,f,de)=>{var Y=xe(),Z=E(Y);p(Z,()=>Ve,(X,$e)=>{$e(X,{children:(_e,De)=>{var G=Sr(),ee=E(G);p(ee,()=>ce,(r,o)=>{o(r,{children:(M,fe)=>{c();var g=v();q(()=>S(g,de+1+(l(a)-1)*T)),t(M,g)},$$slots:{default:!0}})});var le=s(ee,2);p(le,()=>ce,(r,o)=>{o(r,{class:"w-[200px]",children:(M,fe)=>{c();var g=v();q(()=>S(g,l(f).code)),t(M,g)},$$slots:{default:!0}})});var x=s(le,2);p(x,()=>ce,(r,o)=>{o(r,{class:"w-[400px]",children:(M,fe)=>{c();var g=v();q(()=>S(g,l(f).description)),t(M,g)},$$slots:{default:!0}})});var b=s(x,2);p(b,()=>ce,(r,o)=>{o(r,{class:"w-[200px]",children:(M,fe)=>{c();var g=v();q(()=>S(g,`${l(f).discount??""}%`)),t(M,g)},$$slots:{default:!0}})});var h=s(b,2);p(h,()=>ce,(r,o)=>{o(r,{children:(M,fe)=>{c();var g=v();q(()=>S(g,`â‚¹${l(f).minPrice??""} - â‚¹${l(f).maxPrice??""}`)),t(M,g)},$$slots:{default:!0}})});var Q=s(h,2);p(Q,()=>ce,(r,o)=>{o(r,{children:(M,fe)=>{c();var g=v();q(()=>S(g,l(f).numberOfDays)),t(M,g)},$$slots:{default:!0}})});var e=s(Q,2);p(e,()=>ce,(r,o)=>{o(r,{children:(M,fe)=>{mr(M,{get checked(){return l(f).active},class:"text-right",get disabled(){return F().isPending},onclick:()=>F().mutate(l(f)._id)})},$$slots:{default:!0}})}),t(_e,G)},$$slots:{default:!0}})}),t(w,Y)}),t(A,C)},$$slots:{default:!0}})}),t(y,Se)},$$slots:{default:!0}})});var Fe=s(qe,2);{var Ne=i=>{var I=ve(()=>{var y,ne;return((ne=(y=u())==null?void 0:y.data)==null?void 0:ne.total)||0});vr(i,{get total(){return l(I)},get limit(){return T},get page(){return l(a)},callback:y=>{y!==l(a)&&(we(a,ze(y)),u().refetch())}})};K(Fe,i=>{var I,y;!u().isLoading&&((y=(I=u())==null?void 0:I.data)==null?void 0:y.total)>0&&i(Ne)})}_(ie),_(U),t(R,U),Re(),Pe()}var Er=P('<meta name="description" content="dashboard for kings chic.">'),kr=P('<!> <span class="ml-2">Coupon List</span>',1),Fr=P('<!> <span class="ml-2"> </span>',1),Nr=P("<!> <!>",1),Lr=P("<!> <!> <!>",1);function ct(R,ae){Qe(ae,!1);const[j,Pe]=je(),u=()=>te(Oe,"$couponsStore",j);tr(),rr(F=>{var a=Er();er.title="Dashboard | Coupons",t(F,a)}),or(R,{class:"w-full p-4",get value(){return u().mode},onValueChange:F=>{ar(Oe,{id:"",mode:F,code:"",description:"",discount:"",minPrice:0,maxPrice:0,numberOfDays:0})},children:(F,a)=>{var T=Lr(),n=E(T);xr(n,{children:(m,pe)=>{var H=Nr(),U=E(H);Xe(U,{value:"list",class:"flex items-center",children:(J,W)=>{var L=kr(),B=E(L);ke(B,{class:"w-4 h-4",icon:"ic:outline-local-offer"}),c(2),t(J,L)},$$slots:{default:!0}});var oe=s(U,2);Xe(oe,{value:"create",children:(J,W)=>{var L=Fr(),B=E(L);ke(B,{class:"w-4 h-4",icon:"oui:ml-create-single-metric-job"});var se=s(B,2),ie=$(se);_(se),q(()=>S(ie,`${(u().mode=="create"&&u().id?"Edit":"Create")??""} Coupon`)),t(J,L)},$$slots:{default:!0}}),t(m,H)},$$slots:{default:!0}});var N=s(n,2);Ge(N,{value:"list",children:(m,pe)=>{Or(m,{couponsStore:Oe})},$$slots:{default:!0}});var me=s(N,2);Ge(me,{value:"create",children:(m,pe)=>{wr(m,{couponsStore:Oe})},$$slots:{default:!0}}),t(F,T)},$$slots:{default:!0}}),Re(),Pe()}export{ct as component};
