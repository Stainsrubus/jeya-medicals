import"../chunks/Bg9kRutz.js";import"../chunks/69_IOA4Y.js";import{w as dt,p as Xe,u as Ve,g as t,X as Z,d as $,s as n,t as ue,a as Ye,b as de,c as g,n as P,e as Ne,r as h,ad as ct,f as _,$ as ut}from"../chunks/DUB8bsv0.js";import{s as qe}from"../chunks/3nqkJHLA.js";import{b as B,a as r,t as w,c as ee,h as mt}from"../chunks/DzHOuBan.js";import{i as vt}from"../chunks/B06qfcxv.js";import{d as Ce,c as $t,i as ce,s as He,a as Q,p as me,e as ot}from"../chunks/DOmRzZIo.js";import{g as Je}from"../chunks/CSUTd-D0.js";import{R as ft}from"../chunks/B_rXABv2.js";import{z as Re}from"../chunks/K85sQPP8.js";import{s as pt,z as We,d as _t,a as gt}from"../chunks/BTJgjqp0.js";import{s as Ae}from"../chunks/BHIRq8YZ.js";import{d as st}from"../chunks/DbFrp4aS.js";import{_ as Ue}from"../chunks/c3aSOx29.js";import{B as Ke}from"../chunks/CJvYq0KN.js";import{I as Qe}from"../chunks/CJXCr1W0.js";import{L as Ge}from"../chunks/DSP103xp.js";import{q as nt}from"../chunks/tFu-0XeD.js";import{t as be}from"../chunks/CF63kifO.js";import{i as je}from"../chunks/DW9MwCpa.js";import{c as lt}from"../chunks/Dw1g5TC4.js";import{e as ht,i as bt}from"../chunks/DJVbMBk7.js";import{c as v}from"../chunks/yzD5jbIF.js";import{P as xt,T as Ze}from"../chunks/BTrfwMzp.js";import{R as Pt,D as wt,a as yt,b as St}from"../chunks/CeRZbImN.js";import{T as Bt,a as kt,b as et,c as Ie,d as It,e as Te}from"../chunks/4wux5xE3.js";import{S as Tt}from"../chunks/CJEhnKgE.js";import{I as xe}from"../chunks/CHPYNWro.js";import{c as qt}from"../chunks/B6Jqkcen.js";import{T as Lt,a as tt}from"../chunks/B_RvuQCl.js";import{T as rt}from"../chunks/CBD-qeiU.js";const Ee=dt({mode:"list",id:"",name:"",image:""}),at=Re.object({name:Re.string({message:"Name is required"}).max(50),image:Re.string({message:"Image is required"})});var Mt=w('<span class="invalid text-xs text-red-500"> </span>'),Ft=w('<p class="text-xs text-zinc-500">* Click to remove image</p>'),zt=w('<div class="flex flex-col justify-center items-start gap-2 mt-2 hover:cursor-pointer hover:shadow-lg"><button><img class="w-[35px] h-[35px] object-cover rounded-md" alt="Brand Image"></button></div>'),Ct=w('<div class="max-w-[80%] mx-auto text-maintext"><form method="POST" class="grid gap-4 py-4"><div><!> <!> <!></div> <div><!> <!></div> <!> <div class="flex gap-4"><!></div> <!></form></div>');function Et(te,I){Xe(I,!0);const[y,q]=He(),c=()=>Q(I.brandStore,"$brandStore",y),p=()=>Q(Y,"$form",y),re=()=>Q(ae,"$createBrandMutation",y),X=()=>Q(oe,"$errors",y),z=()=>Q(j,"$constraints",y);let b=de(!1),f=de(null),m=de(null),C=null;Ve(()=>{$(b,me(!!(c().mode==="create"&&c().id))),t(b)&&c().image?$(m,`${je}${c().image}`):t(b)||($(m,null),$(f,null)),C=document.getElementById("image")});const ae=lt({mutationFn:e=>t(b)?Ue.put(`/brands/${c().id}`,e):Ue.post("/brands/create",e),onSuccess(){nt.refetchQueries({queryKey:["brand fetch"]}),Ce(I.brandStore,Z(c).mode="list",Z(c)),E(),$(f,null),$(m,null),Je("/hidden-admin-base-007/dashboard/brands?mode=list"),be(t(b)?"Brand Updated ✅":"Brand Created ✅")},onError(e,s,a){console.error("onError",e,s,a)}});function O(e){$(f,null),$(m,null),homePageInput&&(homePageInput.value="")}const{form:Y,errors:oe,enhance:R,constraints:j,reset:E,validateForm:se}=pt(_t(We(at)),{SPA:!0,validationMethod:"oninput",validators:We(at),clearOnSubmit:"none",invalidateAll:!1,resetForm:!1,async onSubmit({}){const{valid:e}=await se({focusOnError:!0});if(!e)return;if(!t(b)&&!t(f)){be.error("Image is required when creating a new brand");return}let s=new FormData;s.append("name",p().name),t(f)&&s.append("image",t(f)),re().mutate(s)}});Ve(()=>{t(b)?(Ce(Y,Z(p).name=c().name,Z(p)),Ce(Y,Z(p).image=c().image,Z(p))):E()});function ve(e,s){var l;const i=(l=e.target.files)==null?void 0:l[0];if(!i)return;if(i.size>51200){be.error("File size is too large! Max size is 50KB"),C&&(C.value="");return}const d=new Image;d.src=URL.createObjectURL(i),d.onload=()=>{const{width:W,height:D}=d;if(W<70||D<70){be.error("Image dimensions must be below 35x35 pixels."),O();return}$(f,me(i)),$(m,null)},d.onerror=()=>{O(),be.error("Invalid image file.")}}function De(){$(f,null),$(m,null),C&&(C.value="")}var Pe=Ct(),we=g(Pe),$e=g(we),ye=g($e);Ge(ye,{for:"name",children:(e,s)=>{P();var a=B("Brand Name");r(e,a)},$$slots:{default:!0}});var Le=n(ye,2),Oe=Ne(()=>X().name?"true":void 0);Qe(Le,$t({id:"name",class:"pr-10 mt-1",placeholder:"Ex: XY Brand",get"aria-invalid"(){return t(Oe)}},()=>z().name,{get value(){return p().name},set value(e){Ce(Y,Z(p).name=e,Z(p))}}));var o=n(Le,2);{var x=e=>{var s=Mt(),a=g(s,!0);h(s),ue(()=>qe(a,X().name)),r(e,s)};ce(o,e=>{X().name&&e(x)})}h($e);var u=n($e,2),H=g(u);Ge(H,{for:"image",children:(e,s)=>{P();var a=B("Image (35 X 35) ~ 50kb");r(e,a)},$$slots:{default:!0}});var J=n(H,2),fe=Ne(()=>!t(b));Qe(J,{id:"image",get required(){return t(fe)},class:"pr-10 mt-1",type:"file",accept:".jpg, .jpeg, .png, .webp",onchange:e=>ve(e)}),h(u);var pe=n(u,2);{var Se=e=>{var s=Ft();r(e,s)};ce(pe,e=>{(t(f)||t(m))&&e(Se)})}var V=n(pe,2),Me=g(V);{var S=e=>{var s=zt(),a=g(s);a.__click=De;var i=g(a);h(a),h(s),ue(d=>Ae(i,"src",d),[()=>t(f)?URL.createObjectURL(t(f)):`${je}${t(m)}`]),r(e,s)};ce(Me,e=>{(t(f)||t(m))&&e(S)})}h(V);var k=n(V,2);Ke(k,{class:"w-[100px]",type:"submit",children:(e,s)=>{P();var a=B();ue(()=>qe(a,t(b)?"Update":re().isPending?"Creating...":"Create")),r(e,a)},$$slots:{default:!0}}),h(we),gt(we,e=>R==null?void 0:R(e)),h(Pe),r(te,Pe),Ye(),q()}st(["click"]);var Ut=w("<!> <!> <!> <!> <!>",1),jt=w('<button><img class="h-[50px] rounded-sm cursor-pointer"></button>'),Dt=(te,I,y,q)=>{ot(y.brandStore,me({...I(),mode:"create",id:t(q)._id,name:t(q).name,image:t(q).image})),Je(`/hidden-admin-base-007/dashboard/brands?mode=create&id=${t(q)._id}`)},Ot=(te,I,y,q)=>($(I,!0),$(y,me(t(q)._id))),Rt=w("<button><!></button> <button><!></button>",1),Nt=w("<!> <!> <!> <!> <!>",1),At=w("<!> <!> <!>",1),Kt=w('<!> <div class="flex gap-4 justify-around"><!> <!></div>',1),Qt=w('<div><div class="mt-6 text-maintext w-[calc(100vw-420px)] font-pt mx-auto"><div class="w-[40%] ml-auto"><div class="grid gap-2 relative"><!> <!></div></div> <!> <!> <!></div></div>');function Xt(te,I){Xe(I,!0);const[y,q]=He(),c=()=>Q(Y,"$query",y),p=()=>Q(oe,"$deleteMutation",y),re=()=>Q(I.brandStore,"$brandStore",y);async function X(o=10,x=1,u=""){return await(await Ue.get(`/brands/all?limit=${o}&page=${x}&q=${u}`)).data}let z=de(1),b=10,f=de(""),m=de(!1),C=de(""),ae;function O(){clearTimeout(ae),ae=setTimeout(async()=>{await ct(),$(z,1),c().refetch()},500)}const Y=qt({queryKey:["brand fetch",O],queryFn:()=>X(b,t(z),t(f))}),oe=lt({mutationFn:({id:o,permanent:x})=>Ue.delete(`/brands/${o}?permanent=${x}`),onSuccess({data:o}){nt.refetchQueries({queryKey:["brand fetch"]}),be((o==null?void 0:o.message)??"Brand Updated ✅"),$(m,!1)},onError(o,x,u){console.error("onError",o,x,u)}});var R=Qt(),j=g(R),E=g(j),se=g(E),ve=g(se);Qe(ve,{type:"text",required:!0,class:"pr-10",placeholder:"Search Brand",oninput:O,get value(){return t(f)},set value(o){$(f,me(o))}});var De=n(ve,2);{var Pe=o=>{xe(o,{icon:"iconamoon:search",class:"absolute right-2 bottom-2.5 cursor-pointer text-gray-400 text-xl"})},we=o=>{xe(o,{icon:"mdi:clear-outline",onclick:()=>{$(f,""),O()},class:"absolute right-2 bottom-2.5 cursor-pointer text-gray-400 text-xl"})};ce(De,o=>{t(f)?o(we,!1):o(Pe)})}h(se),h(E);var $e=n(E,2);v($e,()=>Bt,(o,x)=>{x(o,{class:"",children:(u,H)=>{var J=At(),fe=_(J);{var pe=S=>{var k=ee(),e=_(k);v(e,()=>Ze,(s,a)=>{a(s,{children:(i,d)=>{P();var l=B("Loading....");r(i,l)},$$slots:{default:!0}})}),r(S,k)},Se=S=>{var k=ee(),e=_(k);{var s=a=>{var i=ee(),d=_(i);v(d,()=>Ze,(l,W)=>{W(l,{class:"text-center w-full text-xs",children:(D,ne)=>{P();var G=B("No Brands Found!");r(D,G)},$$slots:{default:!0}})}),r(a,i)};ce(e,a=>{var i,d;((d=(i=c())==null?void 0:i.data)==null?void 0:d.total)===0&&a(s)},!0)}r(S,k)};ce(fe,S=>{c().isLoading?S(pe):S(Se,!1)})}var V=n(fe,2);v(V,()=>kt,(S,k)=>{k(S,{children:(e,s)=>{var a=ee(),i=_(a);v(i,()=>et,(d,l)=>{l(d,{class:"",children:(W,D)=>{var ne=Ut(),G=_(ne);v(G,()=>Ie,(L,M)=>{M(L,{class:"w-[100px]",children:(F,le)=>{P();var U=B("Sl.No");r(F,U)},$$slots:{default:!0}})});var _e=n(G,2);v(_e,()=>Ie,(L,M)=>{M(L,{children:(F,le)=>{P();var U=B("Brand name");r(F,U)},$$slots:{default:!0}})});var ge=n(_e,2);v(ge,()=>Ie,(L,M)=>{M(L,{class:"cursor-pointer",children:(F,le)=>{P();var U=B("Image");r(F,U)},$$slots:{default:!0}})});var Fe=n(ge,2);v(Fe,()=>Ie,(L,M)=>{M(L,{class:"",children:(F,le)=>{P();var U=B("Active");r(F,U)},$$slots:{default:!0}})});var he=n(Fe,2);v(he,()=>Ie,(L,M)=>{M(L,{class:"",children:(F,le)=>{P();var U=B("Actions");r(F,U)},$$slots:{default:!0}})}),r(W,ne)},$$slots:{default:!0}})}),r(e,a)},$$slots:{default:!0}})});var Me=n(V,2);v(Me,()=>It,(S,k)=>{k(S,{children:(e,s)=>{var a=ee(),i=_(a);ht(i,1,()=>{var d;return((d=c().data)==null?void 0:d.brands)||[]},bt,(d,l,W)=>{var D=ee(),ne=_(D);v(ne,()=>et,(G,_e)=>{_e(G,{children:(ge,Fe)=>{var he=Nt(),L=_(he);v(L,()=>Te,(N,A)=>{A(N,{children:(K,ze)=>{P();var T=B();ue(()=>qe(T,W+1+(t(z)-1)*b)),r(K,T)},$$slots:{default:!0}})});var M=n(L,2);v(M,()=>Te,(N,A)=>{A(N,{children:(K,ze)=>{P();var T=B();ue(()=>qe(T,t(l).name)),r(K,T)},$$slots:{default:!0}})});var F=n(M,2);v(F,()=>Te,(N,A)=>{A(N,{children:(K,ze)=>{var T=jt();T.__click=()=>{const Be=window.open();if(Be){const ke=`<img src="${je+t(l).image}" alt="${t(l).name}" />`;Be.document.write(ke),Be.document.title=t(l).name}};var ie=g(T);h(T),ue(()=>{Ae(ie,"src",je+t(l).image),Ae(ie,"alt",t(l).name)}),r(K,T)},$$slots:{default:!0}})});var le=n(F,2);v(le,()=>Te,(N,A)=>{A(N,{children:(K,ze)=>{Tt(K,{class:"text-right",get disabled(){return p().isPending},get checked(){return t(l).active},onclick:()=>p().mutate({id:t(l)._id,permanent:!1})})},$$slots:{default:!0}})});var U=n(le,2);v(U,()=>Te,(N,A)=>{A(N,{class:"gap-4 flex items-center",children:(K,ze)=>{var T=Rt(),ie=_(T);ie.__click=[Dt,re,I,l];var Be=g(ie);xe(Be,{icon:"basil:edit-outline",class:"hover:text-red-500 text-xl"}),h(ie);var ke=n(ie,2);ke.__click=[Ot,m,C,l];var it=g(ke);xe(it,{icon:"mingcute:delete-2-fill",class:"hover:text-red-500 text-xl"}),h(ke),r(K,T)},$$slots:{default:!0}})}),r(ge,he)},$$slots:{default:!0}})}),r(d,D)}),r(e,a)},$$slots:{default:!0}})}),r(u,J)},$$slots:{default:!0}})});var ye=n($e,2);v(ye,()=>Pt,(o,x)=>{x(o,{controlledOpen:!0,get open(){return t(m)},onOpenChange:u=>$(m,me(u)),children:(u,H)=>{var J=ee(),fe=_(J);v(fe,()=>wt,(pe,Se)=>{Se(pe,{children:(V,Me)=>{var S=Kt(),k=_(S);v(k,()=>yt,(i,d)=>{d(i,{class:"text-center",children:(l,W)=>{var D=ee(),ne=_(D);v(ne,()=>St,(G,_e)=>{_e(G,{class:"text-center",children:(ge,Fe)=>{P();var he=B("Do you want to delete this Brand ?");r(ge,he)},$$slots:{default:!0}})}),r(l,D)},$$slots:{default:!0}})});var e=n(k,2),s=g(e);Ke(s,{class:"bg-red-500 text-white font-bold w-full hover:bg-red-400",onclick:()=>p().mutate({id:t(C),permanent:!0}),children:(i,d)=>{P();var l=B("Yes");r(i,l)},$$slots:{default:!0}});var a=n(s,2);Ke(a,{class:"text-white font-bold w-full",onclick:()=>$(m,!1),children:(i,d)=>{P();var l=B("No");r(i,l)},$$slots:{default:!0}}),h(e),r(V,S)},$$slots:{default:!0}})}),r(u,J)},$$slots:{default:!0}})});var Le=n(ye,2);{var Oe=o=>{var x=Ne(()=>{var u,H;return((H=(u=c())==null?void 0:u.data)==null?void 0:H.total)||0});xt(o,{get total(){return t(x)},get limit(){return b},get page(){return t(z)},callback:u=>{u!==t(z)&&($(z,me(u)),c().refetch())}})};ce(Le,o=>{var x,u;!c().isLoading&&((u=(x=c())==null?void 0:x.data)==null?void 0:u.total)>0&&o(Oe)})}h(j),h(R),r(te,R),Ye(),q()}st(["click"]);var Yt=w('<meta name="description" content="dashboard for JME">'),Ht=w('<!> <span class="ml-2">Brands List</span>',1),Jt=w('<!> <span class="ml-2"> </span>',1),Vt=w("<!> <!>",1),Wt=w("<!> <!> <!>",1);function Tr(te,I){Xe(I,!1);const[y,q]=He(),c=()=>Q(Ee,"$brandStore",y);vt(),mt(p=>{var re=Yt();ut.title="Dashboard | Brands",r(p,re)}),ft(te,{get value(){return c().mode},class:"w-full p-4",onValueChange:p=>{Je(`/hidden-admin-base-007/dashboard/brands?mode=${p}`),ot(Ee,{name:"",id:"",mode:p,image:""})},children:(p,re)=>{var X=Wt(),z=_(X);Lt(z,{children:(m,C)=>{var ae=Vt(),O=_(ae);tt(O,{value:"list",class:"flex items-center",children:(oe,R)=>{var j=Ht(),E=_(j);xe(E,{class:"w-4 h-4",icon:"fluent:food-pizza-20-filled"}),P(2),r(oe,j)},$$slots:{default:!0}});var Y=n(O,2);tt(Y,{value:"create",children:(oe,R)=>{var j=Jt(),E=_(j);xe(E,{class:"w-4 h-4",icon:"fluent:square-add-16-regular"});var se=n(E,2),ve=g(se);h(se),ue(()=>qe(ve,`${(c().mode=="create"&&c().id?"Edit":"Create")??""} Brand`)),r(oe,j)},$$slots:{default:!0}}),r(m,ae)},$$slots:{default:!0}});var b=n(z,2);rt(b,{value:"list",children:(m,C)=>{Xt(m,{brandStore:Ee})},$$slots:{default:!0}});var f=n(b,2);rt(f,{value:"create",children:(m,C)=>{Et(m,{brandStore:Ee})},$$slots:{default:!0}}),r(p,X)},$$slots:{default:!0}}),Ye(),q()}export{Tr as component};
